TITLE='Pubs - Participant Bio and pubname'
DESCRIPTION='Show the badgeid, pubsname and bio for each participant that are on at least one scheduled session.'
PUBSWANTS=1
GENCSV=0
QUERY='
  select P.badgeid,
         CD.lastname,
         CD.firstname,
         CD.badgename, 
         P.pubsname, 
         P.bio 
    from Participants P join
         CongoDump CD
   using (badgeid)
         join
     (select distinct(badgeid) 
        from ParticipantOnSession POS, 
             Schedule SCH 
       where POS.sessionid=SCH.sessionid) as X
   using (badgeid) 
order by if(locate(" ",pubsname)!=0,substring(P.pubsname,char_length(pubsname)-locate(" ",reverse(pubsname))+2),pubsname);'
