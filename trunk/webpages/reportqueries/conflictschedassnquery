TITLE='Conflict Report - Assigned v Scheduled issues'
DESCRIPTION='These are sessions that are either in the grid and have no one assigned or the have people assigned and are not in the grid'
CONFLICTWANTS=1

QUERY="
	select trackname, 
	  concat('<a href=StaffAssignParticipants.php?selsess=',S.sessionid,'>', S.sessionid,'</a>') as Sessionid, 
	  title, 
	  if ((SCH.sessionid is NULL),
	    'no room', 
	    concat('<a href=MaintainRoomSched.php?selroom=',R.roomid,'>', R.roomname,'</a>')) in_grid, 
	    if ((num_assigned is NULL), 0, num_assigned) as num_assigned
	from Tracks T, 
	     Sessions S 
	left join Schedule SCH on S.sessionid=SCH.sessionid 
	left join (select sessionid, 
	  count(badgeid) as num_assigned 
	  from ParticipantOnSession group by sessionid) A 
	on A.sessionid=S.sessionid 
	left join Rooms R on R.roomid=SCH.roomid 
	where T.trackid=S.trackid 
	having (in_grid='no room' and num_assigned>0) 
	  or (in_grid!='no room' and (num_assigned<1 or num_assigned is NULL))
	 order by in_grid, num_assigned;"
