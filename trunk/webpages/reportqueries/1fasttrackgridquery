TITLE='Fasttrack Grid'
DESCRIPTION='Display Fast Track schedule with rooms on horizontal axis and time on vertical.\<BR\>Click on the SessionID to add participants, the title to edit the session, or the room name to edit the schedule'
GRIDSWANTS=1
FASTTRACKWANTS=1
PROGWANTS=1
prequery="
     set group_concat_max_len = 25000; 
  Select Group_Concat(distinct RM.list) 
    from (select roomname,
          concat('group_concat(if(roomid=\'', R.roomid,'\',Concat(sessionid,\' \',trackname,\' \',title,\'\ (\',left(duration,5),\')\'),\'\') separator \'\') as \'','<a href=MaintainRoomSched.php?selroom=',R.roomid,'>', R.roomname,'</a> ','\'') as list 
    from Rooms R 
   where function 
    like '%ast%rack%' 
order by display_order) RM;"

q2=`mysql -u $DBUSERNAME $DATABASE -p$DBPASSWORD -N -s -e "$prequery"`

q1="select DATE_FORMAT(ADDTIME('2008-01-18 00:00:00',starttime),'%a %l:%i %p') as 'Start Time', "

q3="
  from (
        SELECT trackname, 
               concat('<a href=StaffAssignParticipants.php?selsess=',S.sessionid,'>', S.sessionid,'</a>') as sessionid,
               SCH.roomid, 
               starttime, 
               duration, 
               concat('<a href=EditSession.php?id=',S.sessionid,'>',title,'</a>') as title
          from Tracks T, 
               Schedule SCH, 
               Sessions S, 
               Rooms R 
         where T.trackname != 'Do Not Print' 
           and S.trackid=T.trackid 
           and S.sessionid = SCH.sessionid 
           and SCH.roomid=R.roomid 
           and R.function like '%ast%rack%') as Z 
      group by starttime;"

QUERY="$q1 $q2 $q3"
