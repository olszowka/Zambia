TITLE='Program Participant Thank you note query'
DESCRIPTION='prefered name, firstname, lastname, mailing address, count of scheduled sessions (for only some tracks!)'
PROGWANTS=1
GENCSV=1
QUERY=" 
       select P.badgeid, 
              P.pubsname, 
              C.firstname, 
              C.lastname, 
              C.postaddress, 
              SCH.sessioncount as 'count(Scheduled sessions)' 
         from CongoDump as C, 
              Participants as P 
   left join (select POS1.badgeid as badgeid , 
                     count(SCH1.sessionid) as sessioncount 
                from ParticipantOnSession POS1, 
                     Schedule SCH1, 
                     Sessions S, 
                     Tracks T 
               where POS1.sessionid=SCH1.sessionid 
                 and SCH1.sessionid=S.sessionid 
                 and S.trackid=T.trackid 
                 and T.trackname in ('ArtProg.', 'Comics', 'Costuming', 'FanInterest', 'FastTrack', 'Filk', 'GamingProg.', 'MediaProg.', 'Literature', 'Science', 'Teen', 'Gaming', 'Reading', 'FocusTopic', 'Geekery', 'Lifestyles', 'AnimeProg.', 'NewItems') 
            group by POS1.badgeid) as SCH 
                  on P.badgeid=SCH.badgeid 
               where SCH.sessioncount is not NULL 
          and C.badgeid=P.badgeid 
    group by (P.badgeid) 
order by cast(P.badgeid as unsigned); "

