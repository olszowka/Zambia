TITLE='Schedule report for Pubs'
DESCRIPTION='Lists all Sessions Scheduled in all Rooms.'
GENCSV=1
PUBSWANTS=1
QUERY="
   select roomname, 
          function, 
          DATE_FORMAT(ADDTIME('2008-01-18 00:00:00',starttime),
                      '%a %l:%i %p') as 'Start Time', 
          concat('(',left(duration,5),')') Duration, trackname,
                 pubsno, S.sessionid, title, 
                 if(group_concat(' ',pubsname) is NULL,
                    '', 
                    group_concat(' ',pubsname)) as 'Participants' 
     from 
          Rooms R, 
          Sessions S, 
          Schedule SCH 
          LEFT JOIN ParticipantOnSession POS 
                 ON SCH.sessionid=POS.sessionid 
          LEFT JOIN CongoDump C 
                 ON POS.badgeid=C.badgeid 
          left join Participants P 
                 on P.badgeid=C.badgeid ,
          Tracks T 
    where T.trackid=S.trackid 
      and SCH.roomid = R.roomid 
      and SCH.sessionid = S.sessionid 
      and S.pubstatusid = 2
 group by SCH.sessionid 
 order by SCH.starttime, 
          R.roomname;"
