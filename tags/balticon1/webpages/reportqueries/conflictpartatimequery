TITLE='Conflict Report - Participants Scheduled Outside Available Times'
DESCRIPTION='Show all participant-sessions scheduled outside set of times participant has listed as being available.'
QUERY="Select FOO.badgeid, CD.badgename, TR.trackname, FOO.sessionid, DATE_FORMAT(ADDTIME('2006-01-13 00:00:00',FOO.starttime),'%a %l:%i %p') as 'Start Time', DATE_FORMAT(ADDTIME('2006-01-13 00:00:00',FOO.endtime),'%a %l:%i %p') as 'End Time', FOO.hours as 'Ttl. Hours Avail.' from (Select SCHD.badgeid, SCHD.trackid, SCHD.sessionid, SCHD.starttime, SCHD.endtime, PAT.availabilitynum, HRS.hours from (Select POS.badgeid, SCH.sessionid, SCH.starttime, ADDTIME(SCH.starttime,S.duration) as endtime, S.trackid from Schedule SCH, ParticipantOnSession POS, Sessions S where SCH.sessionid = POS.sessionid and SCH.sessionid = S.sessionid) as SCHD left join ParticipantAvailabilityTimes PAT on SCHD.badgeid = PAT.badgeid and SCHD.starttime>=PAT.starttime and SCHD.endtime<=PAT.endtime left join (Select badgeid, sum(hour(subtime(endtime,starttime))) as hours from ParticipantAvailabilityTimes group by badgeid) as HRS on SCHD.badgeid=HRS.badgeid having PAT.availabilitynum is null) as FOO, Tracks TR, CongoDump CD where FOO.badgeid = CD.badgeid and FOO.trackid = TR.trackid having FOO.hours is not NULL order by cast(FOO.badgeid as unsigned);"
