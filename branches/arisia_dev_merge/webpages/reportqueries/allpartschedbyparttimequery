TITLE='Full Participant Schedule '
DESCRIPTION='The schedule sorted by participant, then time'
PROGWANTS=1
GOHWANTS=1
QUERY="
  select 
	 if ((P.pubsname is NULL), ' ', concat(' ',P.pubsname,' (',P.badgeid,')')) as 'Participants', 
         if ((moderator=1),'moderator', ' ') as Moderator,
         DATE_FORMAT(ADDTIME('2012-01-13 00:00:00',starttime),'%a %l:%i %p') as 'Start Time', 
         concat(if(left(duration,2)=00, '', if(left(duration,1)=0, 
           concat(right(left(duration,2),1),'hr '), concat(left(duration,2),'hr '))), 
           if(date_format(duration,'%i')=00, '', if(left(date_format(duration,'%i'),1)=0, 
           concat(right(date_format(duration,'%i'),1),'min'), 
           concat(date_format(duration,'%i'),'min')))) Duration,
         concat('<a href=MaintainRoomSched.php?selroom=',R.roomid,'>', R.roomname,'</a>') as Roomname,
         Function, 
         Trackname,
         concat('<a href=StaffAssignParticipants.php?selsess=',S.sessionid,'>', 
                S.sessionid,'</a>') as Sessionid,
         concat('<a href=EditSession.php?id=',S.sessionid,'>',S.title,'</a>') Title
    from Sessions S
    JOIN Schedule SCH 
          USING (sessionid)
    JOIN Rooms R
          USING (roomid)
         LEFT JOIN ParticipantOnSession POS 
                ON SCH.sessionid=POS.sessionid 
         LEFT JOIN Participants P 
                ON POS.badgeid=P.badgeid 
         LEFT JOIN Tracks T 
                ON T.trackid=S.trackid 
order by cast(P.badgeid as unsigned), SCH.starttime;"
