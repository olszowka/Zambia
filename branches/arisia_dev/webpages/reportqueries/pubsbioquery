TITLE='Pubs - Participant Bio and pubname'
DESCRIPTION='Show the badgeid, pubsname and bio for each participant who is on at least one scheduled session.'
PUBSWANTS=1
GENCSV=0
QUERY="
  select P.badgeid,
         CD.lastname,
         CD.firstname,
         CD.badgename, 
         P.pubsname, 
         P.bio 
    from Participants P join
         CongoDump CD
   using (badgeid)
         join
     (select distinct(badgeid) 
        from ParticipantOnSession POS, 
             Schedule SCH 
       where POS.sessionid=SCH.sessionid) as X
   using (badgeid) 
order by IF(instr(P.pubsname,CD.lastname)>0,CD.lastname,substring_index(P.pubsname,' ',-1)),CD.firstname"
